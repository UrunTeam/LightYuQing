<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>属地舆情研判 - ejs-demo</title>
<meta name="renderer" content="webkit">

<link rel="stylesheet" href="http://at.alicdn.com/t/font_1684931_9d5u7tfi0a.css">
<link rel="stylesheet" href="../libs/ElementUI/index.css">
<link rel="stylesheet" href="../css/global.css">
<link rel="stylesheet" href="../css/analisisForense.css">


<!--[if lt IE 9]>
  <script src="//cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
</head>


<body>

    <div class="yuQingContainer">
        <!-- 头部 -->
        <div id="app">
<nav>
        <div class="container">
            <div class="navbar-header flexBetween">
                <div class="navbar-title flexStatr">
                    <div class="navbarIcon" @click='showNav=!showNav'>图</div>
                    <span class="navbar-line"></span>
                    <h2>${pageDetail.name}</h2>
                    <div class="seachInput" v-if='pageDetail.seachInput'>dfsadfasdf</div>
                </div>
                <div class="navbar-right flexAround">
                        <div class="navbar-time">
                            ${year}年${month}月${day}日 
                            <span class="timer-week">${Week}</span> 
                            <span class="time-hours">${hours+':'+minutes+":"+seconds}</span>
                        </div>
                        <div class="navbar-user flexAround">
                            <img src="#" alt="" class="userImg">
                             paul Sadler
                        </div>
                        <!-- 数据整理 -->
                        <div class="navbar-Ordenar rightIcon" @click='pageDetail.ordenar=!pageDetail.ordenar'>
                            <div class="topTooltip">数据整理</div>
                            整
                        </div> 
                        <div class="navbar-setting rightIcon"  @click='pageDetail.setting=!pageDetail.setting'>
                            <div class="topTooltip">基础设置</div>
                            设
                        </div> 
                        <div class="navbar-signOut rightIcon"  @click='signOut'>
                            <div class="topTooltip">退出登录</div>
                            退
                        </div> 
                </div>
            </div>
        </div>
    </nav>
    <div id='navbar-right' v-show='showNav'>
            <div class="container">
               <ul class="navbar-ul">
                   <li v-for='(item,index) in pageArr' :key='index'  :class="item.active?'active':''">
                       <span :class="item.icon"></span>
                       <!-- ${item.name} --> 图
                    </li>
               </ul>
               <ul class="navbar-big">
                   <li v-for='(item,index) in pageArr' :key='index' @click='checkActive(item,index)'  :class="item.active?'active':''">
                        <span :class="item.icon">图</span>
                        <br>   
                        ${item.name.slice(0,4)}
                    </li>
               </ul>
               
            </div>
        </div>
    </div>

        <div id='analisisForense' class="conter">
            <div class="conter-left">
                <!-- 声量趋势 -->
                <div class="conterLeft-top">
                    <div class="comTitleBox flatAngle">
                        <i class="iconfont iconlujing1 incnEdit" @click='dialog=true'></i>
                        <div class="modulTitle">
                            <i class="iconfont iconqushi" ></i>
                            声量趋势
                        </div>
                    </div>
                    <div id="trendChart" ref='trendChart'></div>
                </div>
                <!-- 湖南热点 -->
                <div class="conterLeft-bottom ">
                    <div class="flatAngle comTitleBox">
                        <i class="iconfont iconlujing1 incnEdit"></i>
                        <div class="modulTitle">
                            <i class="iconfont iconredianguanzhu"></i>
                            湖南热点
                        </div>
                    </div>
                    <div class="conterLeft-bottom-item">
                        <ul class="scroll-container">
                            <li class="sort-list flexStart" v-for='(item,index) in hostArr' :key='index'>
                                <span class="hostSort" :class="index>2?'number':'sort'+index+' img'">
                                    ${index>2?index+1:''}
                                </span>
                                <div class="sortConter flexBetween">
                                    <p class="sortConter-top">
                                        ${item.title}
                                    </p>
                                    <div class="sortConter-bottom flexBetween">
                                        <div class="host-media">
                                            <span>${item.media}</span>
                                            <span>${item.date}</span>
                                        </div>
                                        <div class="sortConter-host">
                                            <i class="iconfont iconredianguanzhu"></i>
                                            ${item.host}
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="conter-middle">
                <div class="comTitleBox flexBetween">
                    <i class="iconfont iconlujing1 incnEdit"></i>
                    <div class="modulTitle">
                        <i class="iconfont iconzu8"></i>
                        属地舆情研判
                    </div>
                    <div class="comTitleItem flexStart">
                        <span class="comTitleText">分析时间：</span>
                        <ul class="flexStart">
                            <li v-for='(item,index) in timeArr' @click='changeTime(item,index)'
                                :class="item.active?'active':''" :key='index'>
                                ${item.name}
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="number-total">
                    <dl v-for="(item,index) in analisisArr" :key='index'>
                        <dt>${item.host}</dt>
                        <dd class="f18">${item.name}</dd>
                    </dl>
                </div>
                <div id="mapChart" ref='mapChart'></div>
            </div>
            <div class="conter-right">
                <!-- 情绪分布 -->
                <div class="radiusBox-top">

                    <div class="comTitleBox ">
                        <i class="iconfont iconlujing1 incnEdit"></i>
                        <div class="modulTitle">
                            <i class="iconfont iconxiaolian"></i>
                            情绪分布
                        </div>
                    </div>
                    <div id="pieChart" ref='pieChart'>
                        fsdfsdf
                    </div>
                </div>
                <!-- 舆论热词 -->
                <div class="radiusBox-bottom">
                    <div class="comTitleBox">
                        <i class="iconfont iconlujing1 incnEdit"></i>
                        <div class="modulTitle">
                            <i class="iconfont iconciyun"></i>
                            舆论热词
                        </div>
                    </div>

                </div>
            </div>


            <!-- 弹窗 全网检索功能-->

            <el-dialog :visible.sync="dialog" title="" width="12.68rem" top='0' class="webSearch">
                <div class="searchInput">
                    <input type="text" autocomplete="off" v-model='seachValue' placeholder="请输入关键词">
                    <span class="searchInput-icon">
                        <i class="iconfont iconlujing"></i>
                    </span>
                </div>
                <div class="radioGroup">
                    <el-radio-group v-model="mediaType" size="medium">
                        <el-radio-button label="1">综合</el-radio-button>
                        <el-radio-button label="2">新闻</el-radio-button>
                        <el-radio-button label="3">微博</el-radio-button>
                        <el-radio-button label="4">微信</el-radio-button>
                        <el-radio-button label="5">APP</el-radio-button>
                        <el-radio-button label="6">其他</el-radio-button>
                      </el-radio-group>
                      <div class="groupRight">
                        <span>时间：</span>
                        <el-radio-group v-model="timeType" size="medium">
                            <el-radio-button label="1">近24小时</el-radio-button>
                            <el-radio-button label="2">近7天</el-radio-button>
                            <el-radio-button label="3">近15天</el-radio-button>
                            <el-radio-button label="4">近30天</el-radio-button>
                          </el-radio-group>
                      </div>
                    
                </div>
                <div class="resultConten scroll-container" >
                    <ul class="resultBox flexBetween">
                        <li v-for='(item,index) in 20'>
                            <div class="itemTop flexStart">
                                <img src="../images/hj.png" alt="">
                                <div class="rightText">
                                    <div class="textTitle">湖南<em>长沙</em>"黑老大"犯10宗罪判死刑</div>
                                    <div class="textContent textEllipsis">
                                        长沙环江滨水大道附近，一辆白色SUV驶过中心线，撞上一辆正常行驶的摩托车，
                                        造成摩托车上一家四口3死1伤
                                        长沙环江滨水大道附近，一辆白色SUV驶过中心线，撞上一辆正常行驶的摩托车，
                                        造成摩托车上一家四口3死1伤
                                    </div>
                                </div>
                            </div>
                            <div class="itemBottom flexStart">
                                <div class="bottomleft">
                                    <span><i class="iconfont" :class='getIconClass(mediaType)'></i></span>
                                    澎湃新闻
                                </div>
                                <div class="rightTime">
                                    2018-08-19 19:00 发布
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <div slot="footer" class="dialog-footer">
                    <el-pagination
                    background
                    layout="prev, pager, next"
                    :total="1000">
                    </el-pagination>
                    <div class="footRight textEllipsis">
                        <span>柳州|柳州市|广西柳州)+ (派出所|公安局) + 黑老大+涉黑</span>
                    </div>
                    <!-- <el-button type="warning" @click="dialog = false">取 消</el-button>
                    <el-button type="primary" @click="dialog= false">确 定</el-button> -->
                  </div>
            </el-dialog>

        </div>
        
<script src="../libs/jquery/jquery.min.js"></script>
<script src="../libs/echarts/echarts.min.js"></script>
<script src="../libs/echarts/echarts-wordcloud.min.js"></script>
<script src="../js/resize.js"></script>
<script src="../js/vue.js"></script>
<script src="../libs/ElementUI/index.js"></script>
<script src="../js/global.js"></script>


    </div>

</body>
<!-- <script src='../libs/echarts/mapJson/china.json'></script> -->
<script>
    // import hunanMap from "../libs/echarts/mapJson/hunan.json";
    function initAnalisisForense() {
        var analisisForense = new Vue({
            el: '#analisisForense',
            delimiters: ['${', '}'],
            data() {
                function tipFunction(prams){
                    //地图tooptip样式
                    var name = prams.data.value;
                            var divWarp = $('<div class="div-tip-warp"/>') ;
                            var divContent = $('<div class = "tip-background">');
                            var span = $('<span>').text(name);
                            var divTriangle = $('<div class ="triangle-down hotel-triangle-position">');
                            var divFirst =divContent.append(span);
                            var div = divWarp.append(divFirst).append(divTriangle);
                            return div.html();
                }
                return {
                    // 以下为全网检索数据
                    dialog:true,
                    mediaType:1,// 媒体类型
                    timeType:1,// 时间类型
                    seachValue:'',
                    // 全网检索数据结束

                    // 湖南热点数据

                    hostArr: Array(50).fill({ title: '钟南山为何说有信息4月底基本控制疫情？这份研究给了答案', media: '澎湃新闻', host: 3658, date: '03-03 13:18' }),
                    // 属地舆情研判数据
                    analisisArr: [{ name: '声量总和', host: 1655 }, { name: '正面声量', host: 1655 }, { name: '负面声量', host: 1655 }, { name: '预警声量', host: 1655 }],
                    timeArr: [{ name: '24小时', active: false }, { name: '7天', active: true }, { name: '15天', active: false }, { name: '30天', active: false },],
                    // 情绪分布饼图图表
                    pieChart: {
                        option: {
                            tooltip: {
                                trigger: "item",
                                formatter: "{a}"
                            },
                            color: [
                                "#F7B930",
                                "#F2476B",
                                "#5AB0F3",
                            ],
                            series: [
                                {
                                    name: "",
                                    type: "pie",
                                    radius: ["40%", "70%"], //大小
                                    center: ["52%", "55%"], // 图表在x y的位置
                                    label: {
                                        color: '#fff',
                                        fontSize: 18,
                                        formatter: '{b|{b}}\n{d}%',
                                        rich: {
                                            b: {
                                                lineHeight: 24,
                                                color: '#fff',
                                                fontSize: 18,
                                            }
                                        },
                                    },
                                    data: [],
                                    labelLine: {
                                        show: true
                                    },
                                }
                            ],
                            legend: [
                                {
                                    orient: "vertical",
                                    icon: "path://m43.75,145.74l0,0c0,-51.64 41.86,-93.5 93.5,-93.5l0,0c24.8,0 48.58,9.85 66.11,27.38c17.53,17.53 27.38,41.32 27.38,66.11l0,0c0,51.64 -41.86,93.5 -93.5,93.5l0,0c-51.64,0 -93.5,-41.86 -93.5,-93.5zm46.75,0l0,0c0,25.82 20.93,46.75 46.75,46.75c25.82,0 46.75,-20.93 46.75,-46.75c0,-25.82 -20.93,-46.75 -46.75,-46.75l0,0c-25.82,0 -46.75,20.93 -46.75,46.75z",
                                    left: 20,
                                    top: 40,
                                    itemGap: 22,
                                    textStyle: {
                                        color: '#fff',
                                        fontSize: 18,
                                    },
                                }
                            ]
                        },
                        eachart: null,
                        $el: null
                    },
                    // 声量趋势图表数据
                    trendChart: {
                        option: {
                            tooltip: {
                                trigger: 'axis',
                                axisPointer: {
                                    lineStyle: {
                                        color: '#98B5F4'
                                    }
                                },
                                backgroundColor: 'rgba(164,179,209,1)',
                                textStyle: {
                                    fontSize: '108%',
                                    color: '#11254D'
                                },
                                extraCssText: 'box-shadow: 0px 0px 10px rgba(108,132,156,0.5)'
                            },
                            legend: {
                                textStyle: {
                                    color: '#ffffff',
                                    fontSize: '108%'
                                },
                                icon: 'path://m43.75,145.74l0,0c0,-51.64 41.86,-93.5 93.5,-93.5l0,0c24.8,0 48.58,9.85 66.11,27.38c17.53,17.53 27.38,41.32 27.38,66.11l0,0c0,51.64 -41.86,93.5 -93.5,93.5l0,0c-51.64,0 -93.5,-41.86 -93.5,-93.5zm46.75,0l0,0c0,25.82 20.93,46.75 46.75,46.75c25.82,0 46.75,-20.93 46.75,-46.75c0,-25.82 -20.93,-46.75 -46.75,-46.75l0,0c-25.82,0 -46.75,20.93 -46.75,46.75z',
                                itemGap: 30,
                                right: 10,
                                top: 4,
                            },
                            grid: {
                                top: '20%',
                                left: '5%',
                                right: '5%',
                                bottom: '8%',
                                containLabel: true
                            },
                            xAxis: {
                                boundaryGap: false,
                                axisTick: {
                                    show: true
                                },
                                axisLine: {
                                    lineStyle: {
                                        color: '#98B5F4'
                                    }
                                },
                                axisLabel: {
                                    fontSize: '104%',
                                    color: '#8DA0C6'
                                },
                                data: ["02-14", "02-14", "02-14", "02-14", "02-14", "02-14"]
                            },
                            yAxis: {
                                axisTick: {
                                    show: true
                                },
                                axisLine: {
                                    lineStyle: {
                                        color: '#98B5F4'
                                    }
                                },
                                axisLabel: {
                                    fontSize: '104%',
                                    color: '#8DA0C6'
                                },
                                splitLine: {
                                    lineStyle: {
                                        color: '#98B5F4',
                                        type: 'dashed'
                                    }
                                }
                            },
                            series: [{
                                name: '',
                                type: 'line',
                                hoverAnimation: false,
                                smooth: true,
                                symbolSize: 8,
                                itemStyle: {
                                    color: '#44BC86'
                                },
                                lineStyle: {

                                },
                                data: []
                            },
                            {
                                name: '',
                                type: 'line',
                                hoverAnimation: false,
                                smooth: true,
                                symbolSize: 8,
                                itemStyle: {
                                    color: '#F7B930'
                                },
                                lineStyle: {

                                },
                                data: []
                            },
                            {
                                name: '',
                                type: 'line',
                                hoverAnimation: false,
                                smooth: true,
                                symbolSize: 8,
                                itemStyle: {
                                    color: '#5AB0F3'
                                },
                                lineStyle: {

                                },
                                data: []
                            },
                            {
                                name: '',
                                type: 'line',
                                hoverAnimation: false,
                                smooth: true,
                                symbolSize: 8,
                                itemStyle: {
                                    color: '#F2476B'
                                },
                                lineStyle: {

                                },
                                data: []
                            }
                            ]
                        },
                        eachart: null,
                        $el: null
                    },
                    // 地图图表
                    mapChart: {
                        option: {
                            // backgroundColor: '#044060',
                            // title: {
                            //     text: "长清区示例",

                            //     left: 'center',
                            //     textStyle: {
                            //         color: '#ffffff'
                            //     }
                            // },
                            tooltip:{
                                trigger:'item',
                                formatter:function(params){
                                    return tipFunction(params)
                                },
                                position: function (point, params, dom, rect, size) {
                                    // 固定在顶部
                                    return [point[0]-20, point[1]-46];
                                },
                                backgroundColor:'',
                            },
                            visualMap: {
                                min: 0,
                                max: 200,
                                left: '70',
                                bottom: '40',
                                text: ['200', '0'], // 文本，默认为数值文本
                                calculable: false, //小三角提示数据
                                orient:'horizontal', //是否横向
                                inverse:true, //是否翻转
                                inRange: {
                                    color: ['#009CF3', '#71DEBF', '#FDD835']
                                },
                                textStyle: {
                                    color: '#ffffff'
                                },
                                show:true,
                            },
                            series: [{
                                type: 'map',
                                mapType: 'hunan',
                                label: {
                                    normal: {
                                        show: true
                                    },
                                    emphasis: {
                                        textStyle: {
                                            color: '#000'
                                        }
                                    }
                                },
                                itemStyle: {
                                    normal: {
                                        borderColor: '#fff',
                                        areaColor: '#fff',
                                    },
                                    emphasis: {
                                        areaColor: '#fcdd33',
                                        borderWidth: 0
                                    }
                                },
                                animation: false,
                                // roam: true,
                                data: []
                                // animationDurationUpdate: 1000,
                                // animationEasingUpdate: 'quinticInOut'
                            }]
                        },
                        eachart: null,
                        $el: null
                    },
                    mapName: 'hunan',
                    eachartNameList: ['pieChart', 'trendChart','mapChart'],
                };
            },
            created() {
               
            },
            mounted() {
                let that = this
                // echarts.registerMap(that.mapName, that.hunan);
                this.initEachDom();
                this.initPieChart()
                this.initTrendChart()
                this.initMapChart()
            },
            methods: {
                initEachDom() {
                    let that = this;
                    that.eachartNameList.map((item, index) => {
                        that[item].$el = that.$refs[item];
                        that[item].eachart = echarts.init(that[item].$el);
                    });
                },
                changeTime(item, index) {
                    this.timeArr.map(function (item, index) {
                        item.active = false
                    })
                    this.timeArr[index].active = true
                },
                // 实例化(更新)图表
                updateEach(name) {
                    this[name].eachart.setOption(this[name].option);
                },
                initPieChart() {
                    let dataList = [
                        { value: 300, name: "中立" },
                        { value: 300, name: "负面" },
                        { value: 100, name: "正面" },
                    ];
                    this.pieChart.option.series[0].data = dataList;
                    this.updateEach("pieChart");
                },
                initTrendChart() {
                    let arr = [{ name: '微信', data: [75, 56, 36, 67, 10, 20] },
                    { name: 'APP', data: [54, 65, 89, 20, 10, 20] },
                    { name: '新闻', data: [120, 20, 36, 56, 10, 20] },
                    { name: '微博', data: [5, 20, 36, 65, 10, 67] },
                    ]
                    this.trendChart.option.series.map(function (item, index) {
                        item.name = arr[index].name
                        item.data = arr[index].data
                    })
                    this.updateEach("trendChart");
                },
                initMapChart(){
                    let data=[{name:'常德市',value:0},{name:'张家界市',value:100},
                              {name:'湘西土家族苗族自治州',value:20},{name:'岳阳市',value:80},
                              {name:'益阳市',value:40},{name:'长沙市',value:77},
                              {name:'怀化市',value:50},{name:'娄底市',value:30},
                              {name:'邵阳市',value:60},{name:'衡阳市',value:50},
                              {name:'永州市',value:10},{name:'郴州市',value:66},
                              {name:'湘潭市',value:10},{name:'株洲市',value:66},
                            ]
                    let that=this
                    that.mapChart.option.series[0].data=data
                    $.get('../libs/echarts/mapJson/hunan.json', function (chinaJson) {
                    echarts.registerMap('hunan', chinaJson);
                    console.log(chinaJson)
                    that.updateEach("mapChart");
                });
                },

                // 分割线--------全网检索方法
                // 根矩新闻来源返回不同的图标
                getIconClass(type){
                    let obj={
                        2:'iconzu1',//新闻
                        3:'iconzu13',//微博
                        4:'iconzu3',//微信
                        5:'iconzu1',//APP
                        6:'iconzu1',//其他
                    }
                    return obj[type]||'iconzu1'
                },

            }
        });
    }
    function init() {
        initAnalisisForense()
    }
    init()
</script>

</html>